Original script from ophot, not changed.